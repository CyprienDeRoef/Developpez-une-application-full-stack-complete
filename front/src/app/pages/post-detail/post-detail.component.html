<div class="container-fluid min-vh-100">
  <app-header></app-header>

  <!-- Loading State -->
  <div *ngIf="isLoading">
    <app-loading-spinner></app-loading-spinner>
  </div>

  <!-- Error State -->
  <div *ngIf="!isLoading && !post" class="container mt-4">
    <app-alert-message type="danger" [message]="errorMessage || 'Article non trouvÃ©'"></app-alert-message>
    <button class="btn btn-primary" (click)="goBack()">Retour au fil</button>
  </div>

  <!-- Post Content -->
  <main *ngIf="!isLoading && post" class="container mt-4">
    <article>
      <!-- Back Button and Title -->
      <app-form-header 
        [title]="post.title" 
        [showBackButton]="true"
        (backClicked)="goBack()">
      </app-form-header>

      <!-- Post Meta -->
      <header class="d-flex gap-4 text-muted mb-3">
        <time [attr.datetime]="post.createdAt">{{ post.createdAt | date: 'dd/MM/yyyy' }}</time>
        <span>{{ post.authorName }}</span>
        <span>{{ post.topicNames.join(', ') }}</span>
      </header>

      <!-- Post Content -->
      <div class="mb-5">
        <p style="white-space: pre-wrap;">{{ post.content }}</p>
      </div>
    </article>

    <hr>

    <!-- Comments Section -->
    <section class="mt-5" aria-label="Commentaires">
      <h3 class="mb-4">Commentaires</h3>

      <!-- Comments List -->
      <div class="mb-4">
        <div *ngIf="comments.length === 0" class="text-muted">
          Aucun commentaire pour le moment
        </div>

        <app-comment *ngFor="let comment of comments" [comment]="comment"></app-comment>
      </div>

      <!-- Comment Form -->
      <app-comment-form 
        [commentForm]="commentForm" 
        [isSubmitting]="isSubmitting"
        [errorMessage]="errorMessage"
        (formSubmitted)="onSubmitComment()">
      </app-comment-form>
    </section>
  </main>
</div>
